---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const projects = (await getCollection('projects')).sort((a, b) => a.data.order - b.data.order);
---
<BaseLayout
  title="All Projects | Jacob Meyerkopf"
  description="Explore the full archive of UX, service design, and product engagements with links to every case study."
  mainClass="mx-auto max-w-5xl px-6 pb-24 pt-16"
>
  <section class="mb-12 space-y-4">
    <p class="text-sm font-semibold uppercase tracking-[0.3em] text-brand-600">Project archive</p>
    <h1 class="text-4xl font-bold text-slate-900 dark:text-white">All projects</h1>
    <p class="max-w-2xl text-base text-slate-600 dark:text-slate-300">
      A quick snapshot of every engagement featured on the site—use it to jump directly into the case studies that matter most to
      your roadmap.
    </p>
  </section>

  <div class="space-y-8">
    {projects.map((project) => {
      const data = project.data;
      return (
        <article class="rounded-3xl border border-slate-200/80 bg-white/80 p-6 shadow-lg transition dark:border-slate-800/60 dark:bg-slate-900/70">
          <div class="flex flex-col gap-6 md:flex-row md:items-start md:justify-between">
            <div class="space-y-3">
              <span class="pill">{data.tagline}</span>
              <h2 class="text-2xl font-semibold text-slate-900 dark:text-white">{data.title}</h2>
              <p class="text-base text-slate-700 dark:text-slate-200">{data.summary}</p>
            </div>
            <div class="flex gap-8 text-sm text-slate-600 dark:text-slate-300">
              <div>
                <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-500 dark:text-slate-400">Client</p>
                <p class="mt-1 font-semibold text-slate-900 dark:text-white">{data.client}</p>
              </div>
              <div>
                <p class="text-xs font-semibold uppercase tracking-[0.3em] text-slate-500 dark:text-slate-400">Year</p>
                <p class="mt-1 font-semibold text-slate-900 dark:text-white">{data.year}</p>
              </div>
            </div>
          </div>
          <div class="mt-5 flex flex-wrap gap-3 text-sm text-slate-700 dark:text-slate-300">
            {data.deliverables.map((deliverable) => (
              <span class="rounded-full border border-slate-200/70 px-4 py-1 dark:border-slate-700">{deliverable}</span>
            ))}
          </div>
          {data.links && (
            <div class="mt-6 flex flex-wrap gap-3">
              {data.links.map((link) => (
                <a
                  href={link.href}
                  target={link.external ? '_blank' : undefined}
                  rel={link.external ? 'noopener noreferrer' : undefined}
                  class={
                    link.variant === 'primary'
                      ? 'inline-flex items-center font-semibold text-brand-600 transition hover:text-brand-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-slate-950'
                      : 'inline-flex items-center font-semibold text-slate-700 transition hover:text-brand-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:text-slate-200 dark:focus-visible:ring-offset-slate-950'
                  }
                >
                  {link.label}<span aria-hidden="true" class="ml-2">→</span>
                </a>
              ))}
            </div>
          )}
        </article>
      );
    })}
  </div>
</BaseLayout>
