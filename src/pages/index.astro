---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const projects = (await getCollection('projects')).sort((a, b) => a.data.order - b.data.order);
const featuredProjects = projects.filter((project) => project.data.image);
const testimonialEntry = (await getCollection('testimonials'))[0];
const testimonial = testimonialEntry?.data;

const flagshipCopy = {
  idl: {
    title: 'Rebuilding a 1,000-store rollout workflow',
    oneLiner: 'Cut store drawing time from 8 hours to 37 minutes and saved ~7.4k hours across a retail rollout.',
    tags: ['Workflow design', 'Automation', 'Ops tools']
  },
  'ai-archiving': {
    title: 'AI assistant for a 60k+ item archive',
    oneLiner: 'Designed a human-in-the-loop tagging tool that saves researchers ~5 hours a week with 92% tag accuracy.',
    tags: ['AI/ML', 'Knowledge management', 'Trust & governance']
  }
};

const flagshipProjects = featuredProjects.filter(({ data }) => data.slug && flagshipCopy[data.slug]);
const supportingProjects = featuredProjects.filter(({ data }) => !data.slug || !flagshipCopy[data.slug]);

const toolbox = [
  'Journey mapping',
  'Rapid prototyping',
  'AI workflows',
  'Usability testing',
  'Design systems',
  'Service blueprints'
];

const principles = [
  {
    title: 'Start with real people',
    description: 'I design with real constraints, not just personas in a slide.',
    bullets: [
      'Talk to users early, even if it is scrappy',
      'Let quotes and clips shape requirements',
      'Write problems in plain language first'
    ]
  },
  {
    title: 'Ship small, learn fast',
    description: 'I help teams move from big bets to safe, testable slices.',
    bullets: [
      'Frame work as 1–2 week experiments',
      'Prototype workflows before full build',
      'Measure behavior, not opinions'
    ]
  },
  {
    title: 'Make complexity legible',
    description: 'I turn messy systems into simple, shareable maps.',
    bullets: [
      'Show the whole flow on one page',
      'Highlight risk, not every detail',
      'Use visuals that non-designers can read'
    ]
  }
];

const processSteps = [
  {
    step: '01',
    title: 'Listen',
    description: 'Quick interviews and artifact reviews to understand how work really happens today.'
  },
  {
    step: '02',
    title: 'Map',
    description: 'Visualize the flow, pain points, and opportunities on a single shared canvas.'
  },
  {
    step: '03',
    title: 'Prototype',
    description: 'Test key moments with clickable flows and lightweight experiments.'
  },
  {
    step: '04',
    title: 'Ship & learn',
    description: 'Launch the smallest valuable slice, then adjust based on real usage.'
  }
];
---
<BaseLayout
  title="Jacob Meyerkopf | Product Designer Portfolio"
  description="Product designer blending research, service design, and experimentation to ship measurable outcomes."
  mainClass="mx-auto max-w-6xl px-6 pb-24 pt-16"
>
  <section
    id="about-me"
    class="mb-28 grid gap-12 scroll-mt-24 lg:grid-cols-[1.1fr_0.9fr] lg:items-center"
    data-animate-on-scroll
    data-animate-initial
  >
    <div>
      <h1 class="mt-6 text-4xl font-black leading-tight sm:text-5xl md:text-6xl">I’m a disabled designer who sees where people struggle.</h1>
      <p class="mt-4 max-w-2xl text-lg text-slate-700 dark:text-slate-200">
        I’m Jacob, a product designer &amp; researcher. I uncovered my disabilities later in life, and that experience has enabled me notice hidden problems and move through them with others.
      </p>
    </div>
    <aside
      class="space-y-6 rounded-3xl border border-slate-200/70 bg-white/80 p-8 shadow-lg transition dark:border-slate-800/60 dark:bg-slate-900/70"
      data-animate-on-scroll
      data-animate-delay="0.15s"
    >
      <h2 class="text-sm font-semibold uppercase tracking-[0.35em] text-brand-600">Recent recognition</h2>
      <p class="text-base text-slate-700 dark:text-slate-200">
        "Jacob reframed a stalled project with assumption-mapping workshops and weekly tests. We hit every milestone with confidence." — <strong>Senior Scout, NextStep Basketball</strong>
      </p>
      <div class="flex flex-wrap gap-3">
        <span class="pill">DesignOps</span>
        <span class="pill">Inclusive Research</span>
        <span class="pill">Design Systems</span>
      </div>
    </aside>
  </section>

  <section id="projects" class="mb-28 scroll-mt-24" data-animate-on-scroll>
    <div class="space-y-16">
      <div class="grid gap-8 lg:grid-cols-2">
        {flagshipProjects.map((project, index) => {
          const data = project.data;
          const copy = data.slug ? flagshipCopy[data.slug] : undefined;
          return (
            <article
              class="relative overflow-hidden rounded-3xl border-2 border-brand-500/30 bg-white/90 p-8 shadow-xl transition hover:-translate-y-1 hover:shadow-2xl dark:border-brand-400/30 dark:bg-slate-900/80"
              data-animate-on-scroll
              data-animate-delay={`${index * 80}ms`}
            >
              <div class={`grid gap-6 ${data.image ? 'md:grid-cols-[1.05fr_0.95fr]' : ''}`}>
                <div class="space-y-4">
                  <h3 class="text-2xl font-semibold text-slate-900 dark:text-white">{copy?.title || data.title}</h3>
                  <p class="text-base text-slate-700 dark:text-slate-200">{copy?.oneLiner || data.summary}</p>
                  {copy?.tags && (
                    <div class="flex flex-wrap gap-2">
                      {copy.tags.map((tag) => (
                        <span class="pill">{tag}</span>
                      ))}
                    </div>
                  )}
                  {data.links && (
                    <div class="flex flex-wrap gap-3">
                      {data.links.map((link) => (
                        <a
                          href={link.href}
                          target={link.external ? '_blank' : undefined}
                          rel={link.external ? 'noopener noreferrer' : undefined}
                          class={
                            link.variant === 'primary'
                              ? 'inline-flex items-center font-semibold text-brand-600 transition hover:text-brand-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-slate-950'
                              : 'inline-flex items-center font-semibold text-slate-700 transition hover:text-brand-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:text-slate-200 dark:focus-visible:ring-offset-slate-950'
                          }
                        >
                          {link.label}<span aria-hidden="true" class="ml-2">→</span>
                        </a>
                      ))}
                    </div>
                  )}
                </div>
                {data.image && (
                  <figure class="overflow-hidden rounded-2xl border border-slate-200/80 bg-slate-100/70 p-3 dark:border-slate-800/60 dark:bg-slate-900/60">
                    <img src={data.image.src} alt={data.image.alt} class="w-full rounded-xl object-cover" loading="lazy" />
                  </figure>
                )}
              </div>
            </article>
          );
        })}
      </div>

      {supportingProjects.length > 0 && (
        <div class="space-y-6">
          <div class="grid gap-6 md:grid-cols-2">
            {supportingProjects.map((project, index) => {
              const data = project.data;
              return (
                <article
                  class="rounded-2xl border border-slate-200/80 bg-white/70 p-6 shadow-md transition hover:-translate-y-1 hover:shadow-lg dark:border-slate-800/60 dark:bg-slate-900/70"
                  data-animate-on-scroll
                  data-animate-delay={`${index * 60}ms`}
                >
                  <div class="space-y-4">
                    <div class="flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between">
                      <div class="space-y-2 sm:max-w-[65%]">
                        <p class="text-xs font-semibold uppercase tracking-[0.25em] text-brand-600">{data.tagline}</p>
                        <h4 class="text-xl font-semibold text-slate-900 dark:text-white">{data.title}</h4>
                        <p class="text-sm text-slate-700 dark:text-slate-200">{data.summary}</p>
                      </div>
                      {data.image && (
                        <figure class="overflow-hidden rounded-xl border border-slate-200/70 bg-slate-100/70 p-2 dark:border-slate-800/60 dark:bg-slate-900/60 sm:h-full sm:min-w-[140px]">
                          <img src={data.image.src} alt={data.image.alt} class="h-28 w-full rounded-lg object-cover" loading="lazy" />
                        </figure>
                      )}
                    </div>
                    {data.links && (
                      <div class="flex flex-wrap gap-3">
                        {data.links.map((link) => (
                          <a
                            href={link.href}
                            target={link.external ? '_blank' : undefined}
                            rel={link.external ? 'noopener noreferrer' : undefined}
                            class="inline-flex items-center font-semibold text-slate-800 transition hover:text-brand-600 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:text-slate-100 dark:focus-visible:ring-offset-slate-950"
                          >
                            {link.label}<span aria-hidden="true" class="ml-2">→</span>
                          </a>
                        ))}
                      </div>
                    )}
                  </div>
                </article>
              );
            })}
          </div>
        </div>
      )}
    </div>
  </section>

  <section
    id="methods"
    class="mb-28 space-y-10 scroll-mt-24"
    data-animate-on-scroll
  >
    {/* Top: short, unified story */}
    <div class="max-w-3xl space-y-4">
      <p class="text-xs font-semibold uppercase tracking-[0.25em] text-brand-600">
        Methods
      </p>
      <h2 class="text-3xl font-bold sm:text-4xl">
        Clear tools, simple rules, fast loops
      </h2>
      <p class="text-base leading-relaxed text-slate-600 dark:text-slate-300">
        I work with teams who ship often, juggle constraints, and still care about the details.
        Together we listen, map the work, test small slices, and ship tools that feel lighter and easier to trust.
      </p>
    </div>

    {/* Bottom: Principles + Process + Toolbox in one grid */}
    <div class="grid gap-10 lg:grid-cols-[1.2fr_0.8fr] lg:items-start">
      {/* Left column: principles + process */}
      <div class="space-y-8">
        {/* Principles */}
        <div>
          <p class="text-xs font-semibold uppercase tracking-[0.25em] text-brand-600">
            Principles in practice
          </p>
          <ul class="mt-3 space-y-3 text-sm text-slate-700 dark:text-slate-200">
            {principles.map((principle) => (
              <li class="flex gap-3">
                <span class="mt-1 inline-block h-1.5 w-1.5 shrink-0 rounded-full bg-brand-500" />
                <div>
                  <p class="font-semibold text-slate-900 dark:text-white">
                    {principle.title}
                  </p>
                  <p class="mt-1 text-xs text-slate-600 dark:text-slate-300">
                    {principle.description}
                  </p>
                </div>
              </li>
            ))}
          </ul>
        </div>

        {/* Process */}
        <div>
          <p class="text-xs font-semibold uppercase tracking-[0.25em] text-brand-600">
            Process at a glance
          </p>
          <ol class="mt-3 flex flex-wrap gap-4 text-xs text-slate-700 dark:text-slate-200">
            {processSteps.map((step, index) => (
              <li class="flex items-center gap-2">
                <span class="inline-flex h-7 w-7 items-center justify-center rounded-full border border-slate-300 text-[0.7rem] font-semibold text-brand-600 dark:border-slate-600">
                  {step.step}
                </span>
                <span class="font-medium">{step.title}</span>
                {index !== processSteps.length - 1 && (
                  <span aria-hidden="true" class="text-slate-400">
                    →
                  </span>
                )}
              </li>
            ))}
          </ol>
        </div>
      </div>

      {/* Right column: toolbox */}
      <div
        class="space-y-4 rounded-3xl border border-slate-200/70 bg-gradient-to-br from-brand-50 via-white to-transparent p-6 shadow-lg transition dark:border-slate-800/60 dark:from-brand-900/40 dark:via-slate-900 dark:to-transparent"
      >
        <div class="flex items-center justify-between gap-2">
          <h3 class="text-sm font-semibold text-slate-900 dark:text-white">
            Toolbox
          </h3>
          <p class="text-xs text-slate-500 dark:text-slate-400">
            What I reach for most
          </p>
        </div>
        <div class="flex flex-wrap gap-2 text-xs text-slate-700 dark:text-slate-200">
          {toolbox.map((item) => (
            <span
              key={item}
              class="rounded-full border border-slate-200/80 px-3 py-1 dark:border-slate-700"
            >
              {item}
            </span>
          ))}
        </div>
      </div>
    </div>
  </section>



  {/* TESTIMONIAL / COLLABORATION – NEW IMPLEMENTATION */}
  {testimonial && (
    <section class="mb-28 scroll-mt-24" data-animate-on-scroll>
      <div class="grid gap-10 rounded-3xl border border-slate-200/70 bg-white/80 p-6 shadow-lg transition dark:border-slate-800/60 dark:bg-slate-900/70 lg:grid-cols-[1.1fr_0.9fr] lg:items-center">
        <div class="space-y-4">
          <p class="text-xs font-semibold uppercase tracking-[0.25em] text-brand-600">
            Collaboration
          </p>
          <h2 class="text-3xl font-bold sm:text-4xl">Working together</h2>
          <blockquote class="text-base leading-relaxed text-slate-700 dark:text-slate-200">
            “{testimonial.quote}”
          </blockquote>
          <p class="text-xs text-slate-700 dark:text-slate-300">— {testimonial.source}</p>
        </div>
        <div class="space-y-3 rounded-3xl border border-slate-200/80 bg-gradient-to-br from-brand-50 via-white to-transparent p-5 text-xs text-slate-700 dark:border-slate-800/60 dark:from-brand-900/30 dark:via-slate-900 dark:text-slate-300">
          <h3 class="text-sm font-semibold">What people notice</h3>
          <ul class="mt-2 space-y-2">
            {testimonial.highlights.map((highlight) => (
              <li class="flex items-start gap-2">
                <span class="mt-1 inline-flex h-1.5 w-1.5 shrink-0 rounded-full bg-brand-500" />
                <span>{highlight}</span>
              </li>
            ))}
          </ul>
        </div>
      </div>
    </section>
  )}

  <section
    id="contact"
    class="rounded-3xl border border-brand-500/20 bg-gradient-to-r from-brand-700 via-brand-500 to-brand-300 p-[1px] shadow-xl scroll-mt-24 opacity-25"
    data-animate-on-scroll
  >
    <div class="rounded-[calc(1.5rem-1px)] bg-white p-10 text-center dark:bg-slate-950">
      <p class="text-sm font-semibold uppercase tracking-[0.3em] text-brand-600">Let's build what's next</p>
      <h2 class="mt-4 text-3xl font-bold text-slate-900 dark:text-white sm:text-4xl">Ready to turn complexity into momentum?</h2>
      <p class="mt-3 text-base font-medium text-slate-700 dark:text-slate-200">For leaders seeking a partner who can translate ambiguity into confident product moves.</p>
      <p class="mt-4 text-lg text-slate-700 dark:text-slate-200">
        I'm exploring opportunities across product design, UX research, and emerging AI-driven roles. Share your challenge and I'll respond within two business days.
      </p>
      <div class="mt-8 flex flex-wrap justify-center gap-4">
        <a
          href="mailto:jmeyerkopf@gmail.com"
          class="cta-button cta-button--accent inline-flex items-center rounded-full bg-slate-900 px-6 py-3 font-semibold text-white shadow-lg transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-offset-2 focus-visible:ring-offset-slate-900 dark:bg-white dark:text-slate-900 dark:focus-visible:ring-slate-900 dark:focus-visible:ring-offset-slate-50"
        >
          Let's talk
        </a>
        <a
          href="https://www.linkedin.com/in/jacobmeyerkopf/"
          target="_blank"
          rel="noopener noreferrer"
          class="cta-button cta-button--subtle inline-flex items-center rounded-full border border-slate-300 px-6 py-3 font-semibold text-slate-700 transition hover:border-brand-500 hover:text-brand-600 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:border-slate-700 dark:text-slate-200 dark:hover:border-brand-400 dark:hover:text-brand-200 dark:focus-visible:ring-offset-slate-950"
        >
          Connect on LinkedIn
        </a>
      </div>
    </div>
  </section>
</BaseLayout>

<script is:inline>
  (() => {
    const animatedElements = document.querySelectorAll('[data-animate-on-scroll]');
    if (!animatedElements.length) return;

    const reduceMotionQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
    const shouldReduce = reduceMotionQuery.matches;

    const revealElement = (element) => {
      element.classList.add('is-visible');
    };

    animatedElements.forEach((element) => {
      const delay = element.dataset.animateDelay;
      if (delay) {
        element.style.transitionDelay = delay;
      }
    });

    if (shouldReduce || !('IntersectionObserver' in window)) {
      animatedElements.forEach(revealElement);
      return;
    }

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            revealElement(entry.target);
            observer.unobserve(entry.target);
          }
        });
      },
      { rootMargin: '0px 0px 20% 0px', threshold: 0 }
    );

    animatedElements.forEach((element) => {
      if (element.dataset.animateInitial !== undefined) {
        requestAnimationFrame(() => revealElement(element));
      } else {
        observer.observe(element);
      }
    });
  })();
</script>
